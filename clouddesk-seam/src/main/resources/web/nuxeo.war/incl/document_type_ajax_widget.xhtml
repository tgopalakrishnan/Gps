<f:subview xmlns:f="http://java.sun.com/jsf/core"
  xmlns:c="http://java.sun.com/jstl/core" xmlns:h="http://java.sun.com/jsf/html"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
  xmlns:fn="http://java.sun.com/jsp/jstl/functions"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:nxdir="http://nuxeo.org/nxdirectory"
  xmlns:nxl="http://nuxeo.org/nxforms/layout" id="#{widget.id}">
  <c:if test="#{widget.mode != 'edit' and not empty field}">

    <nxdir:directoryEntryOutput value="#{field}"
      directory="#{widget.properties['directoryName']}"
      localize="#{widget.properties['localize']}" />

  </c:if>
  <c:if test="#{widget.mode == 'edit'}">
    <nxdir:chainSelect size="1" value="#{field}" id="#{widget.id}_editselect"
      multiSelect="false" multiParentSelect="false" allowBranchSelection="false"
      defaultRootKey="" required="#{widget.required}">
      <nxdir:chainSelectListbox index="0" size="1"
        directoryName="#{widget.properties['directoryName']}"
        localize="#{widget.properties['localize']}" id="#{widget.id}"
        ordering="label">
        <a4j:support event="onchange"
         reRender="document_#{mode}" immediate="false" />
      </nxdir:chainSelectListbox>
    </nxdir:chainSelect>
    <a4j:outputPanel ajaxRendered="true">
      <h:message styleClass="errorMessage" for="#{widget.id}_editselect"
        id="#{widget.id}_message" />
    </a4j:outputPanel>

  </c:if>
</f:subview>